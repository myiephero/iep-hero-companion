import{j as e}from"./chunk-DsWtD-um.js";import{r as s}from"./chunk--CdJ9rTh.js";import{a as t,C as a,d as i,e as r,f as n,h as l,L as d,I as c,B as o}from"../assets/index-2BchvXuI.js";import{E as m,x as h,v as x,a1 as u}from"./chunk-CIO6T0Sb.js";import"./chunk-DiCKXT8z.js";const p=()=>{const[p,j]=s.useState("signin"),[g,y]=s.useState(""),[v,f]=s.useState(""),[w,b]=s.useState(!1),[N,k]=s.useState(!1),{toast:S}=t(),C=async e=>{e.preventDefault(),k(!0);try{const e=await fetch("/api/custom-login",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:g,password:v})});if(e.ok){const s=await e.json();s.token&&localStorage.setItem("authToken",s.token),S({title:"Success!",description:"Redirecting to your dashboard..."}),window.location.replace("/parent/dashboard-hero")}else{const s=await e.json();S({title:"Login Failed",description:s.message||"Invalid credentials",variant:"destructive"})}}catch(s){S({title:"Error",description:"Something went wrong",variant:"destructive"})}finally{k(!1)}},E=async e=>{e.preventDefault(),k(!0);try{const e=await fetch("/api/forgot-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:g})});if(e.ok)S({title:"Reset Email Sent",description:"Check your email for password reset instructions."}),j("signin");else{const s=await e.json();S({title:"Error",description:s.message||"Failed to send reset email",variant:"destructive"})}}catch(s){S({title:"Error",description:"Something went wrong",variant:"destructive"})}finally{k(!1)}};return"signin"===p?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-primary/5 via-background to-secondary/5 flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-md space-y-6",children:[e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-primary bg-clip-text text-transparent",children:"My IEP Hero"}),e.jsx("p",{className:"text-muted-foreground",children:"Sign in to your account"})]}),e.jsxs(a,{children:[e.jsxs(i,{children:[e.jsx(r,{children:"Welcome Back"}),e.jsx(n,{children:"Enter your credentials"})]}),e.jsx(l,{children:e.jsxs("form",{onSubmit:C,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"email",children:"Email"}),e.jsx(c,{id:"email",type:"email",value:g,onChange:e=>y(e.target.value),required:!0,disabled:N,"data-testid":"input-email"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"password",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(c,{id:"password",type:w?"text":"password",value:v,onChange:e=>f(e.target.value),required:!0,disabled:N,className:"pr-12","data-testid":"input-password"}),e.jsx(o,{type:"button",variant:"ghost",size:"icon",className:"absolute right-1 top-1/2 -translate-y-1/2 h-9 w-9",onClick:()=>b(!w),"data-testid":"button-toggle-password",children:w?e.jsx(m,{className:"h-4 w-4"}):e.jsx(h,{className:"h-4 w-4"})})]})]}),e.jsx(o,{type:"submit",className:"w-full mt-8",disabled:N,"data-testid":"button-submit",children:N?e.jsxs(e.Fragment,{children:[e.jsx(x,{className:"mr-2 h-4 w-4 animate-spin"}),"Signing in..."]}):"Sign In"}),e.jsx("div",{className:"text-center mt-6",children:e.jsx(o,{type:"button",variant:"link",className:"text-sm text-muted-foreground min-h-[44px]",onClick:()=>j("forgot"),"data-testid":"button-forgot-password",children:"Forgot your password?"})})]})})]})]})}):"forgot"===p?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-primary/5 via-background to-secondary/5 flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-md space-y-6",children:[e.jsxs("div",{className:"text-center space-y-2",children:[e.jsxs(o,{variant:"ghost",onClick:()=>j("signin"),className:"text-sm text-muted-foreground hover:text-primary transition-colors min-h-[44px] px-4","data-testid":"button-back-signin",children:[e.jsx(u,{className:"h-4 w-4 mr-2"}),"Back to Sign In"]}),e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Reset Password"})]}),e.jsxs(a,{children:[e.jsxs(i,{children:[e.jsx(r,{children:"Forgot your password?"}),e.jsx(n,{children:"Enter your email and we'll send you a reset link"})]}),e.jsx(l,{children:e.jsxs("form",{onSubmit:E,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"email",children:"Email"}),e.jsx(c,{id:"email",type:"email",value:g,onChange:e=>y(e.target.value),required:!0,disabled:N,"data-testid":"input-email-reset"})]}),e.jsx(o,{type:"submit",className:"w-full mt-8",disabled:N,"data-testid":"button-send-reset",children:N?e.jsxs(e.Fragment,{children:[e.jsx(x,{className:"mr-2 h-4 w-4 animate-spin"}),"Sending reset email..."]}):"Send Reset Email"})]})})]})]})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-primary/5 via-background to-secondary/5 flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-md space-y-6",children:[e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-primary bg-clip-text text-transparent",children:"My IEP Hero"}),e.jsx("p",{className:"text-muted-foreground",children:"Sign in to your account"})]}),e.jsxs(a,{children:[e.jsxs(i,{children:[e.jsx(r,{children:"Welcome Back"}),e.jsx(n,{children:"Enter your credentials"})]}),e.jsx(l,{children:e.jsxs("form",{onSubmit:C,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"email",children:"Email"}),e.jsx(c,{id:"email",type:"email",value:g,onChange:e=>y(e.target.value),required:!0,disabled:N})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"password",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(c,{id:"password",type:w?"text":"password",value:v,onChange:e=>f(e.target.value),required:!0,disabled:N,className:"pr-10"}),e.jsx(o,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3",onClick:()=>b(!w),children:w?e.jsx(m,{className:"h-4 w-4"}):e.jsx(h,{className:"h-4 w-4"})})]})]}),e.jsx(o,{type:"submit",className:"w-full",disabled:N,children:N?e.jsxs(e.Fragment,{children:[e.jsx(x,{className:"mr-2 h-4 w-4 animate-spin"}),"Signing in..."]}):"Sign In"}),e.jsx("div",{className:"text-center",children:e.jsx(o,{type:"button",variant:"link",className:"text-sm text-muted-foreground",onClick:()=>j("forgot"),children:"Forgot your password?"})})]})})]})]})})};export{p as default};
