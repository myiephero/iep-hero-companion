import{j as e}from"./chunk-DsWtD-um.js";import{r as s,L as a}from"./chunk--CdJ9rTh.js";import{b as t,u as n,c as i}from"./chunk-DiCKXT8z.js";import{T as r}from"./chunk-Dmr1bzLw.js";import{a as l,C as o,d as m,e as c,f as d,h as x,B as h,m as u}from"../assets/index-BO9uTDme.js";import{B as p}from"./chunk-qxwVooB6.js";import{P as j}from"./chunk-D0h9MBRh.js";import{S as g}from"./chunk-DIZ_Na9Q.js";import{B as f,b as N,x as b,y,N as v,Z as w,ae as k,at as _,A as S,T as C,U as A,z as I,a1 as T,aN as E}from"./chunk-CIO6T0Sb.js";import"./chunk-BJKDjCst.js";const B=()=>{const[B,F]=s.useState(""),[G,R]=s.useState(null),[$,L]=s.useState(!1),[q,z]=s.useState(!1),{toast:D}=l(),P=t(),{data:K}=n({queryKey:["/api/students"],queryFn:async()=>(await u("GET","/api/students")).json()}),{data:O,isLoading:U}=n({queryKey:["/api/autism-ai-analysis",B],queryFn:async()=>{if(!B)return null;return(await u("GET",`/api/autism-ai-analysis?student_id=${B}`)).json()},enabled:!!B}),{data:M}=n({queryKey:["/api/autism-profile",B],queryFn:async()=>{if(!B)return null;return(await u("GET",`/api/autism_accommodations/profile?student_id=${B}`)).json()},enabled:!!B}),V=i({mutationFn:async e=>{L(!0);return(await u("POST","/api/autism_accommodations/ai-insights",{student_id:e,analysis_type:"comprehensive"})).json()},onSuccess:e=>{R(e),z(!0),P.invalidateQueries({queryKey:["/api/autism-ai-analysis"]}),D({title:"AI Insights Generated! ðŸ§ âœ¨",description:"Comprehensive autism insights have been generated for your child"})},onError:e=>{console.error("Error generating AI insights:",e),D({title:"Error generating insights",description:"Please try again or ensure the student has completed other autism tools first",variant:"destructive"})},onSettled:()=>{L(!1)}}),Q=()=>M?.sensory_accommodations?.length>0||M?.communication_accommodations?.length>0||M?.behavioral_accommodations?.length>0,W=K?.find(e=>e.id===B)?.full_name||"your child",{completed:Y,total:Z,tools:H}=(()=>{if(!M)return{completed:0,total:3,tools:[]};const e=[{name:"Sensory",completed:(M.sensory_accommodations?.length||0)>0,icon:_},{name:"Communication",completed:(M.communication_accommodations?.length||0)>0,icon:A},{name:"Behavioral",completed:(M.behavioral_accommodations?.length||0)>0,icon:C}];return{completed:e.filter(e=>e.completed).length,total:3,tools:e}})(),J=Math.round(Y/Z*100),X=G||O?.analyses?.[0]?.ai_analysis;return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-orange-50 via-amber-50 to-yellow-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900",children:[e.jsx(r,{}),e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-5xl",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center p-3 bg-gradient-to-r from-orange-500 to-pink-600 rounded-full mb-4",children:e.jsx(f,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{className:"flex items-center justify-center gap-3 mb-2",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"AI Autism Insights"}),e.jsxs(p,{className:"bg-gradient-to-r from-orange-500 to-pink-500 text-white font-bold",children:[e.jsx(N,{className:"h-3 w-3 mr-1"}),"NEW"]})]}),e.jsxs("p",{className:"text-lg text-muted-foreground max-w-2xl mx-auto",children:["Get comprehensive AI-powered insights and recommendations based on ",W,"'s autism profile. Our advanced analysis provides evidence-based strategies and personalized recommendations."]})]}),e.jsxs(o,{className:"mb-6",children:[e.jsxs(m,{children:[e.jsxs(c,{className:"flex items-center gap-2",children:[e.jsx(b,{className:"h-5 w-5 text-orange-600"}),"Student Selection"]}),e.jsx(d,{children:"Choose the student to generate AI insights for"})]}),e.jsx(x,{children:e.jsx(g,{selectedStudent:B,onStudentSelect:F,students:K,placeholder:"Select student for AI insights",className:"max-w-md","data-testid":"select-student"})})]}),B&&e.jsxs(o,{className:"mb-6",children:[e.jsxs(m,{children:[e.jsxs(c,{className:"flex items-center gap-2",children:[e.jsx(y,{className:"h-5 w-5 text-green-600"}),"Profile Completion Status"]}),e.jsx(d,{children:"Complete other autism tools to unlock comprehensive AI insights"})]}),e.jsx(x,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Tools Completed"}),e.jsxs("span",{className:"text-sm font-bold text-primary",children:[Y," of ",Z]})]}),e.jsx(j,{value:J,className:"h-3"}),e.jsx("div",{className:"grid gap-3 md:grid-cols-3",children:H.map(s=>e.jsx(o,{className:"p-3 "+(s.completed?"bg-green-50 dark:bg-green-950 border-green-200 dark:border-green-800":"bg-muted/30"),children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(s.icon,{className:"h-4 w-4 "+(s.completed?"text-green-600":"text-muted-foreground")}),e.jsx("span",{className:"text-sm font-medium",children:s.name}),s.completed?e.jsx(y,{className:"h-3 w-3 text-green-600 ml-auto"}):e.jsx(v,{className:"h-3 w-3 text-muted-foreground ml-auto"})]})},s.name))}),!Q()&&e.jsx("div",{className:"bg-amber-50 dark:bg-amber-950 border border-amber-200 dark:border-amber-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(v,{className:"h-5 w-5 text-amber-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-amber-900 dark:text-amber-100 mb-1",children:"Complete Other Tools First"}),e.jsx("p",{className:"text-sm text-amber-700 dark:text-amber-300",children:"To generate AI insights, please complete at least one of the autism accommodation tools: Sensory, Communication, or Behavioral."}),e.jsxs("div",{className:"flex gap-2 mt-3",children:[e.jsx(h,{asChild:!0,size:"sm",variant:"outline",children:e.jsx(a,{to:"/parent/autism-tools/sensory",children:"Complete Sensory Tool"})}),e.jsx(h,{asChild:!0,size:"sm",variant:"outline",children:e.jsx(a,{to:"/parent/autism-tools/communication",children:"Complete Communication Tool"})}),e.jsx(h,{asChild:!0,size:"sm",variant:"outline",children:e.jsx(a,{to:"/parent/autism-tools/behavioral",children:"Complete Behavioral Tool"})})]})]})]})})]})})]}),Q()&&!X&&e.jsx(o,{className:"mb-6 bg-gradient-to-r from-orange-50 to-pink-50 dark:from-orange-950 dark:to-pink-950 border-orange-200 dark:border-orange-800",children:e.jsxs(x,{className:"p-8 text-center",children:[e.jsx(f,{className:"h-12 w-12 text-orange-600 dark:text-orange-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:"Ready for AI Analysis"}),e.jsxs("p",{className:"text-muted-foreground mb-6 max-w-md mx-auto",children:["Generate comprehensive AI insights based on ",W,"'s completed autism profile tools."]}),e.jsx(h,{onClick:()=>{B?Q()?V.mutate(B):D({title:"Complete other tools first",description:"Please complete at least one accommodation tool (Sensory, Communication, or Behavioral) before generating AI insights",variant:"destructive"}):D({title:"Please select a student",description:"Choose a student to generate AI insights for",variant:"destructive"})},disabled:$||!B,size:"lg",className:"bg-gradient-to-r from-orange-600 to-pink-600 hover:from-orange-700 hover:to-pink-700","data-testid":"button-generate-insights",children:$?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Generating Insights..."]}):e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"h-5 w-5 mr-2"}),"Generate AI Insights"]})})]})}),X&&e.jsxs("div",{className:"space-y-6",children:[e.jsx(o,{className:"bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-950 dark:to-indigo-950 border-blue-200 dark:border-blue-800",children:e.jsxs(x,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(w,{className:"h-6 w-6 text-blue-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"AI Analysis Complete!"}),e.jsxs(p,{className:"bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300",children:["Generated ",O?.analyses?.[0]?.timestamp?new Date(O.analyses[0].timestamp).toLocaleDateString():"Recently"]})]}),e.jsxs("p",{className:"text-muted-foreground",children:["Comprehensive autism insights have been generated for ",W,". Review the detailed analysis and recommendations below."]})]})}),X.key_findings&&e.jsxs(o,{children:[e.jsx(m,{children:e.jsxs(c,{className:"flex items-center gap-2",children:[e.jsx(k,{className:"h-5 w-5 text-yellow-600"}),"Key Findings"]})}),e.jsx(x,{children:e.jsx("ul",{className:"space-y-3",children:X.key_findings.map((s,a)=>e.jsxs("li",{className:"flex items-start gap-3",children:[e.jsx(y,{className:"h-5 w-5 text-green-600 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-muted-foreground",children:s})]},a))})})]}),X.detailed_analysis&&e.jsxs(o,{children:[e.jsx(m,{children:e.jsxs(c,{className:"flex items-center gap-2",children:[e.jsx(f,{className:"h-5 w-5 text-purple-600"}),"Detailed Analysis"]})}),e.jsx(x,{children:e.jsx("div",{className:"prose prose-sm max-w-none dark:prose-invert",children:e.jsx("p",{className:"text-muted-foreground whitespace-pre-wrap",children:X.detailed_analysis})})})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[X.environmental_modifications&&e.jsxs(o,{children:[e.jsx(m,{children:e.jsxs(c,{className:"flex items-center gap-2 text-base",children:[e.jsx(_,{className:"h-4 w-4 text-blue-600"}),"Environmental Modifications"]})}),e.jsx(x,{children:e.jsx("ul",{className:"space-y-2 text-sm",children:X.environmental_modifications.map((s,a)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(S,{className:"h-3 w-3 text-blue-600 mt-1 flex-shrink-0"}),e.jsx("span",{className:"text-muted-foreground",children:s})]},a))})})]}),X.visual_supports&&e.jsxs(o,{children:[e.jsx(m,{children:e.jsxs(c,{className:"flex items-center gap-2 text-base",children:[e.jsx(b,{className:"h-4 w-4 text-green-600"}),"Visual Supports"]})}),e.jsx(x,{children:e.jsx("ul",{className:"space-y-2 text-sm",children:X.visual_supports.map((s,a)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(S,{className:"h-3 w-3 text-green-600 mt-1 flex-shrink-0"}),e.jsx("span",{className:"text-muted-foreground",children:s})]},a))})})]}),X.self_regulation&&e.jsxs(o,{children:[e.jsx(m,{children:e.jsxs(c,{className:"flex items-center gap-2 text-base",children:[e.jsx(C,{className:"h-4 w-4 text-purple-600"}),"Self-Regulation Strategies"]})}),e.jsx(x,{children:e.jsx("ul",{className:"space-y-2 text-sm",children:X.self_regulation.map((s,a)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(S,{className:"h-3 w-3 text-purple-600 mt-1 flex-shrink-0"}),e.jsx("span",{className:"text-muted-foreground",children:s})]},a))})})]}),X.social_strengths&&e.jsxs(o,{children:[e.jsx(m,{children:e.jsxs(c,{className:"flex items-center gap-2 text-base",children:[e.jsx(A,{className:"h-4 w-4 text-pink-600"}),"Social Strengths"]})}),e.jsx(x,{children:e.jsx("ul",{className:"space-y-2 text-sm",children:X.social_strengths.map((s,a)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(S,{className:"h-3 w-3 text-pink-600 mt-1 flex-shrink-0"}),e.jsx("span",{className:"text-muted-foreground",children:s})]},a))})})]})]}),X.evidence_base&&e.jsxs(o,{children:[e.jsx(m,{children:e.jsxs(c,{className:"flex items-center gap-2",children:[e.jsx(I,{className:"h-5 w-5 text-indigo-600"}),"Evidence-Based Foundation"]})}),e.jsx(x,{children:e.jsx("p",{className:"text-muted-foreground text-sm",children:X.evidence_base})})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between items-center mt-8 pt-6 border-t",children:[e.jsx(h,{asChild:!0,variant:"ghost","data-testid":"button-back-to-autism-hub",children:e.jsxs(a,{to:"/parent/autism-tools",className:"flex items-center gap-2",children:[e.jsx(T,{className:"h-4 w-4"}),"Back to Autism Tools"]})}),X&&e.jsxs("div",{className:"flex gap-4",children:[e.jsxs(h,{variant:"outline",onClick:()=>{const e=`Autism AI Insights Report for ${W}\n\nGenerated: ${(new Date).toLocaleDateString()}\n\n${X.detailed_analysis||""}\n\nKey Findings:\n${(X.key_findings||[]).map((e,s)=>`${s+1}. ${e}`).join("\n")}`,s=new Blob([e],{type:"text/plain"}),a=URL.createObjectURL(s),t=document.createElement("a");t.href=a,t.download=`${W}-autism-ai-insights-${(new Date).toISOString().split("T")[0]}.txt`,t.click(),URL.revokeObjectURL(a)},"data-testid":"button-download-report",children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),"Download Report"]}),e.jsx(h,{asChild:!0,"data-testid":"button-view-accommodations",children:e.jsxs(a,{to:"/parent/students",className:"flex items-center gap-2",children:["View in Student Profile",e.jsx(S,{className:"h-4 w-4"})]})})]})]})]})]})};export{B as default};
