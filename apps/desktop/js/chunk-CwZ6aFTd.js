const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-4xq_U8Za.js","js/chunk-DsWtD-um.js","js/chunk--CdJ9rTh.js","js/chunk-CIO6T0Sb.js","js/chunk-DiCKXT8z.js","assets/index-CB6eufAz.css"])))=>i.map(i=>d[i]);
import{a as e,u as s,C as a,d as t,e as i,h as n,B as l,r,t as c,v as d,w as o,x as m,m as x,_ as p}from"../assets/index-4xq_U8Za.js";import{j as h}from"./chunk-DsWtD-um.js";import{r as u}from"./chunk--CdJ9rTh.js";import{u as j}from"./chunk--P05M-BP.js";import{P as g}from"./chunk-CeDn3LK_.js";import{B as f}from"./chunk-dWvI_tCU.js";import{A as y,a as N}from"./chunk-OMBrO3Ds.js";import{D as v,a as w,b,c as C,d as k}from"./chunk-DtPYXc3G.js";import{S,a as A,b as _,c as D,d as P}from"./chunk-C503eIeV.js";import{a as I}from"./chunk-blGGLRwb.js";import{u as E}from"./chunk-W7T4nVof.js";import{aU as $,v as z,Q as U,aL as T,B as O,f as F,ad as L,az as R,y as q,N as V,aJ as M,x as B,aN as J,aw as G,aW as K,X as Q,av as X,j as W,a2 as Y,U as H,M as Z,T as ee,Y as se,au as ae,ab as te}from"./chunk-CIO6T0Sb.js";const ie=({analysis:e,onSaveToVault:s,onCreateLetter:x,onMeetingPrep:p})=>{const[j,g]=u.useState({});let y;const N=e=>{g(s=>({...s,[e]:!s[e]}))},v=e=>j[e]||!1;try{y="string"==typeof e.content?JSON.parse(e.content):e.content}catch(b){return h.jsxs("div",{className:"mt-4 p-4 bg-muted rounded-lg",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[h.jsx(O,{className:"h-4 w-4 text-primary"}),h.jsxs("span",{className:"font-medium",children:[e.type.toUpperCase()," Analysis"]}),h.jsx(f,{variant:"secondary",className:"text-xs",children:new Date(e.timestamp).toLocaleString()})]}),h.jsx("div",{className:"text-sm whitespace-pre-wrap",children:e.content})]})}return h.jsxs("div",{className:"mt-4 space-y-4",children:[h.jsxs("div",{className:"flex items-center justify-between p-4 bg-primary/5 rounded-lg border",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(O,{className:"h-5 w-5 text-primary"}),h.jsxs("span",{className:"font-semibold text-lg",children:[e.type.toUpperCase()," Analysis Results"]})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs(f,{variant:"secondary",className:"text-xs",children:[h.jsx(se,{className:"h-3 w-3 mr-1"}),new Date(e.timestamp).toLocaleString()]}),y.compliance_score&&h.jsxs(f,{className:(w=y.compliance_score,w>=80?"text-green-600 bg-green-50 border-green-200":w>=60?"text-yellow-600 bg-yellow-50 border-yellow-200":"text-red-600 bg-red-50 border-red-200")+" font-medium",children:[h.jsx(Y,{className:"h-3 w-3 mr-1"}),y.compliance_score,"/100"]}),y.status&&h.jsx(f,{className:(e=>{switch(e?.toLowerCase()){case"excellent":return"bg-green-100 text-green-700";case"good":return"bg-blue-100 text-blue-700";case"needs improvement":return"bg-yellow-100 text-yellow-700";case"poor":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}})(y.status),children:y.status}),(s||x||p)&&h.jsxs(r,{children:[h.jsx(c,{asChild:!0,children:h.jsxs(l,{size:"sm",className:"gap-2 bg-blue-600 hover:bg-blue-700 text-white","data-testid":"button-analysis-actions",children:[h.jsx(L,{className:"h-3 w-3"}),"Actions",h.jsx(X,{className:"h-2 w-2"})]})}),h.jsxs(d,{align:"end",className:"w-48",children:[s&&h.jsxs(o,{onClick:s,className:"flex items-center gap-2","data-testid":"menu-save-vault",children:[h.jsx(L,{className:"h-4 w-4"}),"Save to Vault"]}),x&&h.jsxs(o,{onClick:x,className:"flex items-center gap-2","data-testid":"menu-create-letter",children:[h.jsx(Z,{className:"h-4 w-4"}),"Create Letter"]}),p&&h.jsxs(o,{onClick:p,className:"flex items-center gap-2","data-testid":"menu-meeting-prep",children:[h.jsx(H,{className:"h-4 w-4"}),"Meeting Prep"]}),h.jsx(m,{}),h.jsxs(o,{onClick:()=>{const s=JSON.stringify(e,null,2),a="data:application/json;charset=utf-8,"+encodeURIComponent(s),t=`${e.type}-analysis-${(new Date).toISOString().split("T")[0]}.json`,i=document.createElement("a");i.setAttribute("href",a),i.setAttribute("download",t),i.click()},className:"flex items-center gap-2","data-testid":"menu-export-analysis",children:[h.jsx(J,{className:"h-4 w-4"}),"Export Analysis"]}),h.jsxs(o,{onClick:()=>{navigator.clipboard.writeText(JSON.stringify(e,null,2))},className:"flex items-center gap-2","data-testid":"menu-copy-clipboard",children:[h.jsx(K,{className:"h-4 w-4"}),"Copy to Clipboard"]})]})]})]})]}),y.summary&&h.jsxs(a,{children:[h.jsx(t,{className:"pb-3",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs(i,{className:"flex items-center gap-2 text-base",children:[h.jsx(F,{className:"h-4 w-4"}),"Executive Summary"]}),h.jsx(l,{variant:"ghost",size:"sm",onClick:()=>N("summary"),className:"h-8 w-8 p-0",children:v("summary")?h.jsx(X,{className:"h-4 w-4"}):h.jsx(ae,{className:"h-4 w-4"})})]})}),!v("summary")&&h.jsx(n,{children:h.jsx("p",{className:"text-sm leading-relaxed",children:y.summary})})]}),y.recommendations&&y.recommendations.length>0&&h.jsxs(a,{children:[h.jsx(t,{className:"pb-3",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs(i,{className:"flex items-center gap-2 text-base",children:[h.jsx(te,{className:"h-4 w-4 text-blue-600"}),"Key Recommendations"]}),h.jsx(l,{variant:"ghost",size:"sm",onClick:()=>N("recommendations"),className:"h-8 w-8 p-0",children:v("recommendations")?h.jsx(X,{className:"h-4 w-4"}):h.jsx(ae,{className:"h-4 w-4"})})]})}),!v("recommendations")&&h.jsx(n,{children:h.jsx("ul",{className:"space-y-2",children:y.recommendations.map((e,s)=>h.jsxs("li",{className:"flex items-start gap-2 text-sm",children:[h.jsx(f,{variant:"outline",className:"text-xs font-medium mt-0.5 shrink-0",children:s+1}),h.jsx("span",{className:"leading-relaxed",children:e})]},s))})})]}),y.areas_of_concern&&y.areas_of_concern.length>0&&h.jsxs(a,{children:[h.jsx(t,{className:"pb-3",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs(i,{className:"flex items-center gap-2 text-base",children:[h.jsx(V,{className:"h-4 w-4 text-amber-600"}),"Areas of Concern"]}),h.jsx(l,{variant:"ghost",size:"sm",onClick:()=>N("concerns"),className:"h-8 w-8 p-0",children:v("concerns")?h.jsx(X,{className:"h-4 w-4"}):h.jsx(ae,{className:"h-4 w-4"})})]})}),!v("concerns")&&h.jsx(n,{children:h.jsx("ul",{className:"space-y-2",children:y.areas_of_concern.map((e,s)=>h.jsxs("li",{className:"flex items-start gap-2 text-sm",children:[h.jsx(f,{variant:"secondary",className:"text-xs mt-0.5 shrink-0 bg-amber-100 text-amber-700",children:"⚠"}),h.jsx("span",{className:"leading-relaxed",children:e})]},s))})})]}),y.strengths&&y.strengths.length>0&&h.jsxs(a,{children:[h.jsx(t,{className:"pb-3",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs(i,{className:"flex items-center gap-2 text-base",children:[h.jsx(q,{className:"h-4 w-4 text-green-600"}),"Identified Strengths"]}),h.jsx(l,{variant:"ghost",size:"sm",onClick:()=>N("strengths"),className:"h-8 w-8 p-0",children:v("strengths")?h.jsx(X,{className:"h-4 w-4"}):h.jsx(ae,{className:"h-4 w-4"})})]})}),!v("strengths")&&h.jsx(n,{children:h.jsx("ul",{className:"space-y-2",children:y.strengths.map((e,s)=>h.jsxs("li",{className:"flex items-start gap-2 text-sm",children:[h.jsx(f,{variant:"secondary",className:"text-xs mt-0.5 shrink-0 bg-green-100 text-green-700",children:"✓"}),h.jsx("span",{className:"leading-relaxed",children:e})]},s))})})]}),y.action_items&&y.action_items.length>0&&h.jsxs(a,{children:[h.jsx(t,{className:"pb-3",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs(i,{className:"flex items-center gap-2 text-base",children:[h.jsx(ee,{className:"h-4 w-4 text-purple-600"}),"Next Steps & Action Items"]}),h.jsx(l,{variant:"ghost",size:"sm",onClick:()=>N("actions"),className:"h-8 w-8 p-0",children:v("actions")?h.jsx(X,{className:"h-4 w-4"}):h.jsx(ae,{className:"h-4 w-4"})})]})}),!v("actions")&&h.jsx(n,{children:h.jsx("ul",{className:"space-y-2",children:y.action_items.map((e,s)=>h.jsxs("li",{className:"flex items-start gap-2 text-sm",children:[h.jsx(f,{variant:"outline",className:"text-xs font-medium mt-0.5 shrink-0 bg-purple-50 text-purple-700 border-purple-200",children:s+1}),h.jsx("span",{className:"leading-relaxed",children:e})]},s))})})]})]});var w};function ne({onAnalysisComplete:se,selectedAnalysisType:ae="iep_quality"}){const[te,ne]=u.useState([]),[le,re]=u.useState(null),[ce,de]=u.useState(null),[oe,me]=u.useState([]),[xe,pe]=u.useState(""),{toast:he}=e(),{user:ue}=s(),{captureFromCamera:je,captureFromGallery:ge,captureWithPrompt:fe,convertToFile:ye,isCapturing:Ne,isNative:ve}=E();u.useEffect(()=>{ue&&(async()=>{try{localStorage.getItem("authToken");const e=await x("GET","/api/students"),s=await e.json();me(s||[])}catch(e){console.error("Error fetching students:",e)}})()},[ue]);const we=u.useCallback(async e=>{if(!ue)return void he({title:"Authentication required",description:"Please sign in to upload documents.",variant:"destructive"});const s=e.map(e=>({file:e,id:crypto.randomUUID(),progress:0,status:"uploading"}));ne(e=>[...e,...s]);for(const t of s)try{await be(t)}catch(a){Ce(t.id,"error")}},[ue,he]),be=async e=>{const s=setInterval(()=>{ne(s=>s.map(s=>s.id===e.id?{...s,progress:Math.min(s.progress+10,90)}:s))},100);try{await new Promise(e=>setTimeout(e,1e3)),clearInterval(s),Ce(e.id,"completed"),he({title:"Upload successful",description:`${e.file.name} has been uploaded and is ready for analysis.`})}catch(a){clearInterval(s),Ce(e.id,"error"),he({title:"Upload failed",description:a.message||"Failed to upload file",variant:"destructive"})}},Ce=(e,s,a)=>{ne(t=>t.map(t=>t.id===e?{...t,status:s,progress:"completed"===s?100:t.progress,url:a}:t))},ke=e=>{ne(s=>s.filter(s=>s.id!==e))},Se=e=>{ne(s=>s.map(s=>s.id===e?{...s,isEditing:!0,editableName:s.editableName||s.file.name}:s))},Ae=e=>{ne(s=>s.map(s=>s.id===e?{...s,isEditing:!1}:s))},_e=async(e,s)=>{re(e.id);try{if("text/plain"===e.file.type){const a=await e.file.text(),t=await I.analyzeDocument(a,s),i={type:s,content:t.analysis,timestamp:t.timestamp||(new Date).toISOString()};ne(s=>s.map(s=>s.id===e.id?{...s,analysis:i}:s)),se?.(i),he({title:"Analysis complete",description:"Document analysis has been completed successfully."})}let t;t="application/pdf"===e.file.type?await(a=e.file,new Promise((e,s)=>{const t=new FileReader;t.onload=s=>{const a=s.target?.result;e(a||"")},t.onerror=()=>s(new Error("Failed to read file")),t.readAsDataURL(a)})):await(e=>new Promise((s,a)=>{const t=new FileReader;t.onload=e=>{const a=e.target?.result;s(a||"")},t.onerror=()=>a(new Error("Failed to read file")),t.readAsText(e)}))(e.file);const i=await x("POST","/api/process-document",{fileName:e.file.name,fileContent:t,analysisType:s}),n=await i.json(),l={type:s,content:n.analysis,timestamp:(new Date).toISOString(),documentId:n.documentId,parsedAnalysis:n.parsedAnalysis};ne(s=>s.map(s=>s.id===e.id?{...s,analysis:l}:s)),se?.(l),he({title:"Analysis complete",description:"Document processing has been completed successfully."})}catch(t){he({title:"Analysis failed",description:t.message||"Failed to analyze document. Please try uploading a text (.txt) file for best results.",variant:"destructive"})}finally{re(null)}var a},{getRootProps:De,getInputProps:Pe,isDragActive:Ie}=j({onDrop:we,accept:{"text/plain":[".txt"],"application/pdf":[".pdf"],"application/msword":[".doc"],"application/vnd.openxmlformats-officedocument.wordprocessingml.document":[".docx"]},maxSize:10485760});return h.jsxs("div",{className:"space-y-6",children:[h.jsxs(a,{children:[h.jsx(t,{children:h.jsxs(i,{className:"flex items-center gap-2",children:[h.jsx($,{className:"h-5 w-5"}),"Document Upload & AI Analysis"]})}),h.jsxs(n,{children:[h.jsxs("div",{...De(),className:"border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors "+(Ie?"border-primary bg-primary/5":"border-muted-foreground/25 hover:border-primary/50"),children:[h.jsx("input",{...Pe()}),h.jsx($,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),Ie?h.jsx("p",{children:"Drop the files here..."}):h.jsxs("div",{children:[h.jsx("p",{className:"text-lg font-medium mb-2",children:"Drag & drop files here, or click to select"}),h.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Supports: TXT, PDF, DOC, DOCX (max 10MB) • PDF extraction fully supported!"}),h.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 justify-center items-center",children:[h.jsx("span",{className:"text-sm text-muted-foreground",children:"Or capture directly:"}),h.jsxs("div",{className:"flex gap-2",children:[h.jsxs(l,{type:"button",variant:"outline",size:"sm",onClick:e=>{e.stopPropagation(),(async()=>{if(!ue)return void he({title:"Authentication required",description:"Please sign in to capture documents.",variant:"destructive"});const e=await je();if(e){const a={file:ye(e),id:crypto.randomUUID(),progress:0,status:"uploading"};ne(e=>[...e,a]);try{await be(a)}catch(s){Ce(a.id,"error")}}})()},disabled:Ne,className:"gap-2","data-testid":"button-camera-capture",children:[Ne?h.jsx(z,{className:"h-4 w-4 animate-spin"}):h.jsx(U,{className:"h-4 w-4"}),ve?"Camera":"Camera*"]}),h.jsxs(l,{type:"button",variant:"outline",size:"sm",onClick:e=>{e.stopPropagation(),(async()=>{if(!ue)return void he({title:"Authentication required",description:"Please sign in to select documents.",variant:"destructive"});const e=await ge();if(e){const a={file:ye(e),id:crypto.randomUUID(),progress:0,status:"uploading"};ne(e=>[...e,a]);try{await be(a)}catch(s){Ce(a.id,"error")}}})()},disabled:Ne,className:"gap-2","data-testid":"button-gallery-capture",children:[Ne?h.jsx(z,{className:"h-4 w-4 animate-spin"}):h.jsx(T,{className:"h-4 w-4"}),ve?"Gallery":"Browse*"]})]})]}),!ve&&h.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"* Full camera support available in mobile app"})]})]}),h.jsxs(y,{className:"mt-4",children:[h.jsx(O,{className:"h-4 w-4"}),h.jsx(N,{children:"Upload IEP documents, evaluation reports, or other educational documents for AI-powered analysis and insights."})]})]})]}),te.length>0&&h.jsxs(a,{children:[h.jsx(t,{children:h.jsx(i,{children:"Uploaded Files"})}),h.jsx(n,{className:"space-y-4",children:te.map(e=>h.jsxs("div",{className:"border rounded-lg p-4",children:[h.jsxs("div",{className:"flex items-center justify-between mb-2",children:[h.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[h.jsx(F,{className:"h-4 w-4"}),e.isEditing?h.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[h.jsx("input",{type:"text",value:e.editableName||e.file.name,onChange:s=>{return a=e.id,t=s.target.value,void ne(e=>e.map(e=>e.id===a?{...e,editableName:t}:e));var a,t},className:"flex-1 px-2 py-1 text-sm border rounded focus:outline-none focus:ring-2 focus:ring-primary",onKeyDown:s=>{"Enter"===s.key&&Ae(e.id),"Escape"===s.key&&ne(s=>s.map(s=>s.id===e.id?{...s,isEditing:!1,editableName:s.file.name}:s))},autoFocus:!0}),h.jsx(l,{variant:"ghost",size:"sm",onClick:()=>Ae(e.id),className:"h-8 w-8 p-0",children:h.jsx(L,{className:"h-3 w-3"})})]}):h.jsxs("div",{className:"flex items-center gap-2 flex-1 group",children:[h.jsx("span",{className:"font-medium",children:e.editableName||e.file.name}),h.jsx(l,{variant:"ghost",size:"sm",onClick:()=>Se(e.id),className:"h-6 w-6 p-0 opacity-0 group-hover:opacity-100 transition-opacity","data-testid":`button-edit-name-${e.id}`,children:h.jsx(R,{className:"h-3 w-3"})})]}),"completed"===e.status&&h.jsx(q,{className:"h-4 w-4 text-green-500"}),"error"===e.status&&h.jsx(V,{className:"h-4 w-4 text-red-500"})]}),h.jsxs("div",{className:"flex items-center gap-2",children:["completed"===e.status&&h.jsx(h.Fragment,{children:h.jsxs(r,{children:[h.jsx(c,{asChild:!0,children:h.jsx(l,{variant:"outline",size:"sm",className:"h-8 w-8 p-0","data-testid":`button-menu-${e.id}`,children:h.jsx(M,{className:"h-4 w-4"})})}),h.jsxs(d,{align:"end",className:"w-48",children:[h.jsxs(o,{onClick:()=>{const s=URL.createObjectURL(e.file);window.location.replace(s)},"data-testid":`menu-view-${e.id}`,children:[h.jsx(B,{className:"h-4 w-4 mr-2"}),"View"]}),h.jsxs(o,{onClick:()=>{const s=document.createElement("a");s.href=URL.createObjectURL(e.file),s.download=e.file.name,s.click()},"data-testid":`menu-download-${e.id}`,children:[h.jsx(J,{className:"h-4 w-4 mr-2"}),"Download"]}),h.jsxs(o,{onClick:()=>de(e.id),"data-testid":`menu-assign-student-${e.id}`,children:[h.jsx(G,{className:"h-4 w-4 mr-2"}),"Assign to Student"]}),h.jsx(m,{}),h.jsxs(o,{onClick:()=>(async e=>{try{await x("POST","/api/documents",{title:e.editableName||e.file.name,description:`Document uploaded on ${(new Date).toLocaleDateString()}`,file_name:e.editableName||e.file.name,file_path:`vault/uploads/${e.id}`,file_type:e.file.type,file_size:e.file.size,category:"Upload",tags:["uploaded-document"]}),await p(async()=>{const{queryClient:e}=await import("../assets/index-4xq_U8Za.js").then(e=>e.O);return{queryClient:e}},__vite__mapDeps([0,1,2,3,4,5])).then(({queryClient:e})=>{e.invalidateQueries({queryKey:["/api/documents"]})}),he({title:"Saved to Vault",description:"File has been saved to your document vault."})}catch(s){he({title:"Error",description:"Failed to save to vault. Please try again.",variant:"destructive"})}})(e),"data-testid":`menu-save-vault-${e.id}`,children:[h.jsx(L,{className:"h-4 w-4 mr-2"}),"Save to Vault"]}),h.jsxs(o,{onClick:()=>(async e=>{const s=`Check out this document: ${e.editableName||e.file.name}`;if(navigator.share)try{await navigator.share({title:"Document Share",text:s})}catch(a){await navigator.clipboard.writeText(s),he({title:"Copied to Clipboard",description:"Share text copied to clipboard."})}else await navigator.clipboard.writeText(s),he({title:"Copied to Clipboard",description:"Share text copied to clipboard."})})(e),"data-testid":`menu-share-${e.id}`,children:[h.jsx(K,{className:"h-4 w-4 mr-2"}),"Share"]}),h.jsxs(o,{onClick:()=>Se(e.id),"data-testid":`menu-edit-name-${e.id}`,children:[h.jsx(R,{className:"h-4 w-4 mr-2"}),"Edit Name"]}),h.jsx(m,{}),h.jsxs(o,{onClick:()=>ke(e.id),className:"text-destructive focus:text-destructive focus:bg-destructive/10","data-testid":`menu-remove-${e.id}`,children:[h.jsx(Q,{className:"h-4 w-4 mr-2"}),"Remove"]})]})]})}),"completed"!==e.status&&h.jsx(l,{variant:"ghost",size:"sm",onClick:()=>ke(e.id),className:"h-8 w-8 p-0","data-testid":`button-remove-${e.id}`,children:h.jsx(Q,{className:"h-4 w-4"})})]})]}),"uploading"===e.status&&h.jsx(g,{value:e.progress,className:"mb-2"}),h.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mb-3",children:[h.jsxs("span",{children:[(e.file.size/1024/1024).toFixed(2)," MB"]}),h.jsx(f,{variant:"outline",children:e.file.type}),h.jsx(f,{variant:"completed"===e.status?"default":"error"===e.status?"destructive":"secondary",children:e.status})]}),"completed"===e.status&&h.jsx("div",{className:"flex items-center gap-2",children:h.jsxs(r,{children:[h.jsx(c,{asChild:!0,children:h.jsxs(l,{size:"sm",variant:"outline",disabled:le===e.id,className:"flex items-center gap-2",children:[le===e.id?h.jsx(z,{className:"h-4 w-4 animate-spin"}):h.jsx(O,{className:"h-4 w-4"}),"AI Analysis",h.jsx(X,{className:"h-3 w-3"})]})}),h.jsxs(d,{align:"start",className:"w-56",children:[h.jsxs(o,{onClick:()=>_e(e,"iep_quality"),disabled:le===e.id,className:"flex items-center gap-2",children:[h.jsx(W,{className:"h-4 w-4"}),h.jsxs("div",{children:[h.jsx("div",{className:"font-medium",children:"IEP Quality Review"}),h.jsx("div",{className:"text-xs text-muted-foreground",children:"Comprehensive quality analysis with scoring"})]})]}),h.jsxs(o,{onClick:()=>_e(e,"compliance_check"),disabled:le===e.id,className:"flex items-center gap-2",children:[h.jsx(Y,{className:"h-4 w-4"}),h.jsxs("div",{children:[h.jsx("div",{className:"font-medium",children:"Compliance Analysis"}),h.jsx("div",{className:"text-xs text-muted-foreground",children:"Check IDEA compliance and requirements"})]})]}),h.jsxs(o,{onClick:()=>_e(e,"accommodation"),disabled:le===e.id,className:"flex items-center gap-2",children:[h.jsx(H,{className:"h-4 w-4"}),h.jsxs("div",{children:[h.jsx("div",{className:"font-medium",children:"Accommodation Analysis"}),h.jsx("div",{className:"text-xs text-muted-foreground",children:"Review accommodation effectiveness"})]})]}),h.jsxs(o,{onClick:()=>_e(e,"meeting_prep"),disabled:le===e.id,className:"flex items-center gap-2",children:[h.jsx(Z,{className:"h-4 w-4"}),h.jsxs("div",{children:[h.jsx("div",{className:"font-medium",children:"Meeting Preparation"}),h.jsx("div",{className:"text-xs text-muted-foreground",children:"Prepare for IEP meetings"})]})]}),h.jsxs(o,{onClick:()=>_e(e,"goal_analysis"),disabled:le===e.id,className:"flex items-center gap-2",children:[h.jsx(ee,{className:"h-4 w-4"}),h.jsxs("div",{children:[h.jsx("div",{className:"font-medium",children:"Goal Analysis"}),h.jsx("div",{className:"text-xs text-muted-foreground",children:"Analyze IEP goals and progress"})]})]})]})]})}),e.analysis&&h.jsx(ie,{analysis:e.analysis,onSaveToVault:()=>(async e=>{if(e.analysis)try{const s=`${e.analysis.type.toUpperCase()} Analysis - ${e.editableName||e.file.name}`,a=`${e.analysis.type} analysis completed on ${new Date(e.analysis.timestamp).toLocaleDateString()}`,t=JSON.stringify(e.analysis.parsedAnalysis||JSON.parse(e.analysis.content));await x("POST","/api/documents",{title:s,description:a,file_name:`${s}.json`,file_path:`vault/analysis/${e.id}-${e.analysis.type}`,file_type:"application/json",file_size:new Blob([t]).size,category:"AI Analysis",tags:[e.analysis.type,"analysis-result","ai-generated"]}),await p(async()=>{const{queryClient:e}=await import("../assets/index-4xq_U8Za.js").then(e=>e.O);return{queryClient:e}},__vite__mapDeps([0,1,2,3,4,5])).then(({queryClient:e})=>{e.invalidateQueries({queryKey:["/api/documents"]})}),he({title:"Analysis Saved to Vault",description:`${e.analysis.type.toUpperCase()} analysis has been saved to your document vault.`})}catch(s){he({title:"Error",description:"Failed to save analysis to vault. Please try again.",variant:"destructive"})}})(e),onCreateLetter:()=>{const s=e.analysis?.type;const a=new URLSearchParams({context:"analysis",analysisType:s||"",fileName:e.editableName||e.file.name,timestamp:e.analysis?.timestamp||(new Date).toISOString()});window.location.href=`/tools/smart-letter-generator?${a.toString()}`},onMeetingPrep:()=>{window.location.href="advocate"===ue?.role?"/advocate/schedule":"/parent/meeting-prep"}})]},e.id))})]}),h.jsx(v,{open:!!ce,onOpenChange:e=>{e||(de(null),pe(""))},children:h.jsxs(w,{className:"sm:max-w-md",children:[h.jsxs(b,{children:[h.jsx(C,{children:"Assign to Student"}),h.jsx(k,{children:"Select a student to assign this document to for tracking and organization."})]}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Select Student"}),h.jsxs(S,{value:xe,onValueChange:pe,children:[h.jsx(A,{children:h.jsx(_,{placeholder:"Choose a student..."})}),h.jsx(D,{children:(oe||[]).map(e=>h.jsx(P,{value:e.id,children:h.jsxs("div",{children:[h.jsx("div",{className:"font-medium",children:e.full_name}),e.grade_level&&h.jsxs("div",{className:"text-sm text-muted-foreground",children:["Grade ",e.grade_level]})]})},e.id))})]})]}),h.jsxs("div",{className:"flex justify-end gap-2",children:[h.jsx(l,{variant:"outline",onClick:()=>{de(null),pe("")},children:"Cancel"}),h.jsx(l,{onClick:()=>{if(!xe||!ce)return;const e=oe.find(e=>e.id===xe);e&&(ne(s=>s.map(s=>s.id===ce?{...s,assignedStudentId:xe,assignedStudentName:e.full_name}:s)),he({title:"Student Assigned",description:`File assigned to ${e.full_name}`}),de(null),pe(""))},disabled:!xe,children:"Assign Student"})]})]})]})})]})}export{ne as D};
